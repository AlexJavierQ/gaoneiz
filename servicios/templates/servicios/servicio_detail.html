{% extends 'base.html' %}

{% block title %}{{ servicio.nombre }} - Servicios{% endblock %}

{% block content %}
<!-- Breadcrumb -->
<section class="py-3 bg-light">
    <div class="container">
        <nav class="breadcrumb-custom">
            <ol class="breadcrumb mb-0">
                <li class="breadcrumb-item"><a href="{% url 'web:home' %}">Inicio</a></li>
                <li class="breadcrumb-item"><a href="{% url 'servicios:servicio_list' %}">Servicios</a></li>
                <li class="breadcrumb-item active">{{ servicio.nombre }}</li>
            </ol>
        </nav>
    </div>
</section>

<!-- Service Detail -->
<section class="py-5">
    <div class="container">
        <div class="row g-5">
            <div class="col-lg-8">
                <div class="custom-card">
                    <div class="card-body">
                        <!-- Service Header -->
                        <div class="d-flex justify-content-between align-items-start mb-4">
                            <div>
                                <span class="category-badge mb-2 d-inline-block">{{ servicio.get_categoria_display
                                    }}</span>
                                <h1 class="card-title mb-0">{{ servicio.nombre }}</h1>
                            </div>
                            {% if servicio.solo_socios %}
                            <span class="status-badge status-pending">
                                <i class="fas fa-star me-1"></i>Solo Socios
                            </span>
                            {% endif %}
                        </div>

                        <!-- Service Image -->
                        {% if servicio.imagen %}
                        <div class="mb-4">
                            <img src="{{ servicio.imagen.url }}" alt="{{ servicio.nombre }}"
                                class="img-fluid rounded shadow-sm w-100" style="max-height: 400px; object-fit: cover;">
                        </div>
                        {% endif %}

                        <!-- Service Description -->
                        <div class="mb-4">
                            <h4><i class="fas fa-info-circle text-primary me-2"></i>Descripción del Servicio</h4>
                            <div class="lead">{{ servicio.descripcion|linebreaks }}</div>
                        </div>

                        <!-- Service Details -->
                        <div class="mb-4">
                            <h4><i class="fas fa-list text-primary me-2"></i>Detalles del Servicio</h4>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <div class="info-row">
                                        <span class="info-label">Categoría:</span>
                                        <span class="info-value">{{ servicio.get_categoria_display }}</span>
                                    </div>
                                </div>
                                {% if servicio.precio %}
                                <div class="col-md-6">
                                    <div class="info-row">
                                        <span class="info-label">Precio:</span>
                                        <span class="info-value">
                                            <span class="h5 text-primary mb-0">
                                                <i class="fas fa-dollar-sign me-1"></i>${{ servicio.precio }}
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                {% endif %}
                                <div class="col-md-6">
                                    <div class="info-row">
                                        <span class="info-label">Disponibilidad:</span>
                                        <span class="info-value">
                                            {% if servicio.solo_socios %}
                                            <span class="status-badge status-pending">Solo para Socios</span>
                                            {% else %}
                                            <span class="status-badge status-active">Público</span>
                                            {% endif %}
                                        </span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="info-row">
                                        <span class="info-label">Fecha de Creación:</span>
                                        <span class="info-value">{{ servicio.fecha_creacion|date:"d \d\e F, Y" }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="mb-4">
                            {% if servicio.solo_socios and not user.es_socio %}
                            <div class="alert alert-warning-custom">
                                <i class="fas fa-lock me-2"></i>
                                <strong>Servicio Exclusivo</strong><br>
                                Este servicio está disponible únicamente para socios de la Cámara de Comercio.
                            </div>
                            {% if user.is_authenticated %}
                            <a href="{% url 'afiliaciones:solicitar_afiliacion' %}" class="btn btn-primary">
                                <i class="fas fa-handshake me-2"></i>Solicitar Afiliación
                            </a>
                            {% else %}
                            <a href="{% url 'account_signup' %}" class="btn btn-primary">
                                <i class="fas fa-user-plus me-2"></i>Regístrate Ahora
                            </a>
                            {% endif %}
                            {% else %}
                            <div class="d-flex gap-3 flex-wrap">
                                <a href="{% url 'web:contacto' %}" class="btn btn-primary btn-lg">
                                    <i class="fas fa-envelope me-2"></i>Solicitar Información
                                </a>
                                <button class="btn btn-outline-primary btn-lg" onclick="window.print()">
                                    <i class="fas fa-print me-2"></i>Imprimir
                                </button>
                                <button class="btn btn-outline-secondary btn-lg" onclick="shareService()">
                                    <i class="fas fa-share me-2"></i>Compartir
                                </button>
                            </div>
                            {% endif %}
                        </div>

                        <div class="mt-4">
                            <a href="{% url 'servicios:servicio_list' %}" class="btn btn-secondary">
                                <i class="fas fa-arrow-left me-2"></i>Volver a Servicios
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-4">
                <!-- Contact Info -->
                <div class="custom-card mb-4">
                    <div class="card-body">
                        <h5 class="card-title">
                            <i class="fas fa-phone text-primary me-2"></i>Información de Contacto
                        </h5>
                        <div class="info-item mb-3">
                            <i class="fas fa-map-marker-alt"></i>
                            <div>
                                <strong>Dirección:</strong><br>
                                Av. Universidad y José Antonio Eguiguren<br>
                                Loja, Ecuador
                            </div>
                        </div>
                        <div class="info-item mb-3">
                            <i class="fas fa-phone"></i>
                            <div>
                                <strong>Teléfono:</strong><br>
                                +593 7 257-0407
                            </div>
                        </div>
                        <div class="info-item mb-3">
                            <i class="fas fa-envelope"></i>
                            <div>
                                <strong>Email:</strong><br>
                                info@camaraloja.org.ec
                            </div>
                        </div>
                        <div class="info-item mb-3">
                            <i class="fas fa-clock"></i>
                            <div>
                                <strong>Horario:</strong><br>
                                Lunes a Viernes: 8:00 AM - 5:00 PM<br>
                                Sábados: 8:00 AM - 12:00 PM
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Related Services -->
                <div class="custom-card">
                    <div class="card-body">
                        <h5 class="card-title">
                            <i class="fas fa-cogs text-primary me-2"></i>Otros Servicios
                        </h5>
                        <p class="card-text">Explora más servicios disponibles en la misma categoría.</p>
                        <a href="{% url 'servicios:servicios_por_categoria' servicio.categoria %}"
                            class="btn btn-outline-primary w-100">
                            <i class="fas fa-list me-2"></i>Ver {{ servicio.get_categoria_display }}
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- FAQ Section -->
<section class="py-5 bg-light">
    <div class="container">
        <h2 class="section-title">Preguntas Frecuentes</h2>
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <div class="accordion" id="faqAccordion">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                data-bs-target="#faq1">
                                ¿Cómo puedo acceder a este servicio?
                            </button>
                        </h2>
                        <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                {% if servicio.solo_socios %}
                                Este servicio está disponible únicamente para socios activos de la Cámara de Comercio.
                                Si eres socio, puedes contactarnos directamente. Si no eres socio, puedes solicitar tu
                                afiliación.
                                {% else %}
                                Este servicio está disponible para el público en general. Puedes contactarnos
                                directamente
                                para solicitar más información o programar una cita.
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#faq2">
                                ¿Cuál es el tiempo de respuesta?
                            </button>
                        </h2>
                        <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Normalmente respondemos a las solicitudes de información en un plazo de 24 a 48 horas
                                hábiles.
                                Para servicios urgentes, puedes contactarnos directamente por teléfono.
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#faq3">
                                ¿Hay descuentos disponibles?
                            </button>
                        </h2>
                        <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Los socios de la Cámara de Comercio pueden acceder a tarifas preferenciales en muchos de
                                nuestros servicios.
                                Contacta con nosotros para conocer las tarifas específicas.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    function shareService() {
        if (navigator.share) {
            navigator.share({
                title: '{{ servicio.nombre }}',
                text: '{{ servicio.descripcion|truncatewords:20 }}',
                url: window.location.href
            });
        } else {
            // Fallback: copy to clipboard
            navigator.clipboard.writeText(window.location.href).then(() => {
                alert('Enlace copiado al portapapeles');
            });
        }
    }
</script>
{% endblock %}